<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.hypeboy.codemeets.model.dao.LoginDao">
    <select id="findUserByUsername" resultType="UserDto">
   		SELECT user_pk userPk, user_id userId, password, token, user_name userName 
   		user_active userActive, user_info_pk userInfoPk, nickname, tel, email, 
   		profile_photo profilePhoto, email_public emailPublic, tel_public telPublic
        FROM user NATURAL JOIN user_info
        WHERE user_id = #{userId}
    </select>
    
	<select id="getUserInfo" resultType="UserDto">
   		SELECT user_pk userPk, user_id userId,
   		user_active userActive, nickname, tel, email, 
   		profile_photo profilePhoto, email_public emailPublic, tel_public telPublic
        FROM user NATURAL JOIN user_info
        WHERE user_id = #{userId}
    </select>
    
    <!-- ==================== token ==================== -->
    <update id="saveRefreshToken" parameterType="map">
		UPDATE user
		SET token = #{token}
		WHERE user_id = #{id}
	</update>
    
    <select id="getRefreshToken" parameterType="string" resultType="string">
		SELECT token
		FROM user
		WHERE user_id = #{userId}
	</select>

</mapper>

